<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>(Incident Response tactics with Compromise Indicators)</title>
<meta name="author" content="(Vladimir Kropotov, Vitaly Chetvertakov, Fyodor Yarochkin)"/>
<link rel="stylesheet" href="./reveal.js/css/reveal.min.css"/>
<link rel="stylesheet" href="./reveal.js/css/theme/moon.css" id="theme"/>

<link rel="stylesheet" href="./reveal.js/css/print/pdf.css" type="text/css" media="print"/>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
ox-reveal-jekyll-preamble
<div class="reveal">
<div class="slides">
<section>
<h1>Incident Response tactics with Compromise Indicators</h1>
<h2>Vladimir Kropotov, Vitaly Chetvertakov, Fyodor Yarochkin</h2>
<h2><a href="mailto:voffchik@gmail.com">voffchik@gmail.com</a></h2>
<h2></h2></section>
<section>
<h2>Table of Contents</h2><ul>
<li>
<a href="#sec-1">О　теме　по　русски</a>
</li>
<li>
<a href="#sec-2">Basics</a>
</li>
<li>
<a href="#sec-3">IOC workflow</a>
</li>
<li>
<a href="#sec-4">Standards: OpenIOC</a>
</li>
<li>
<a href="#sec-5">Standards: Mitre</a>
</li>
<li>
<a href="#sec-6">Tools</a>
</li>
<li>
<a href="#sec-7">Online Sharing of IOCs</a>
</li>
<li>
<a href="#sec-8">Sharing IOCS</a>
</li>
<li>
<a href="#sec-9">IOCs composites</a>
</li>
<li>
<a href="#sec-10">Challenges</a>
</li>
<li>
<a href="#sec-11">Challenges</a>
</li>
<li>
<a href="#sec-12">An Example</a>
</li>
<li>
<a href="#sec-13">Indicators</a>
</li>
<li>
<a href="#sec-14">Good or Bad?</a>
</li>
<li>
<a href="#sec-15">It really depends on context</a>
</li>
<li>
<a href="#sec-16">Tools for Dynamic Detection of IOC</a>
</li>
<li>
<a href="#sec-17">Platforms useful for IOC</a>
</li>
</ul>
</section>

<section>
<section id="sec-1" >

<h2>О　теме　по　русски</h2>
<p>
Практическое применение статистических и временных индикаторов для
выявления и расследования инцидентов ИБ
</p>

<p>
поговорим　о　том　что　такое　индикаторы　　компромисов　и　с　чем　их　едять.
</p>
</section>

</section>
<section>
<section id="sec-2" >

<h2>Basics</h2>
<p>
<b>Indicators of Compromise</b>
</p>

<p>
Indicator of compromise (IOC) in computer forensics is an artifact
observed on network or in operating system that with high confidence
indicates a computer intrusion.
</p>

<p>
<a href="http://en.wikipedia.org/wiki/Indicator_of_compromise">http://en.wikipedia.org/wiki/Indicator_of_compromise</a>
</p>
</section>


</section>
<section>
<section id="sec-3" >

<h2>IOC workflow</h2>
<p>
A typical flow with Indicators of Compromise allows
to integrate dynamic threat intelligence into detection 
process:
</p>

<img src="images/ioc.png" alt="ioc.png" />

<p>
source: Sophisticated indicators for the modern threat landscape, 2012
paper
</p>
</section>
</section>
<section>
<section id="sec-4" >

<h2>Standards: OpenIOC</h2>
<p>
OpenIOC - Mandiant-backed effort for unform representation of IOC
(now FireEye)
<a href="http://www.openioc.org/">http://www.openioc.org/</a>
<img src="images/zeus-ioc.png" alt="zeus-ioc.png" />
</p>
</section>
</section>
<section>
<section id="sec-5" >

<h2>Standards: Mitre</h2>
<p>
Mitre CybOX:
<a href="http://cybox.mitre.org/">http://cybox.mitre.org/</a>
<a href="https://github.com/CybOXProject/Tools">https://github.com/CybOXProject/Tools</a>
<a href="https://github.com/CybOXProject/openioc-to-cybox">https://github.com/CybOXProject/openioc-to-cybox</a>
Mitre CAPEC:
<a href="http://capec.mitre.org/">http://capec.mitre.org/</a>
Mitre STIX:
<a href="http://stix.mitre.org/">http://stix.mitre.org/</a>
Mitre TAXII
<a href="http://taxii.mitre.org/">http://taxii.mitre.org/</a>
</p>
</section>
</section>
<section>
<section id="sec-6" >

<h2>Tools</h2>
<p>
<a href="https://github.com/STIXProject/openioc-to-stix">https://github.com/STIXProject/openioc-to-stix</a>
<a href="https://github.com/tklane/openiocscripts">https://github.com/tklane/openiocscripts</a> 
</p>

<p>
Mantis Threat Intelligence Framework
 <a href="https://github.com/siemens/django-mantis.git">https://github.com/siemens/django-mantis.git</a>
Mantis supports STIX/CybOX/IODEF/OpenIOC etc via
importers: <a href="https://github.com/siemens/django-mantis-openioc-importer">https://github.com/siemens/django-mantis-openioc-importer</a>
</p>


<p>
Search splunk data for IOC indicators:
<a href="https://github.com/technoskald/splunk-search">https://github.com/technoskald/splunk-search</a>
</p>
</section>
</section>
<section>
<section id="sec-7" >

<h2>Online Sharing of IOCs</h2>
<p>
<a href="http://iocbucket.com/">http://iocbucket.com/</a>
</p>

<img src="images/iocbucket.png" alt="iocbucket.png" />
</section>
</section>
<section>
<section id="sec-8" >

<h2>Sharing IOCS</h2>
<p>
Policies on sharing IOCs:
</p>

<ul class="org-ul">
<li>what to be shared/can be shared
</li>
<li>who to share with
</li>
<li>when to share
</li>
</ul>
</section>
</section>
<section>
<section id="sec-9" >

<h2>IOCs composites</h2>
<p>
Where to look for IOCs:
</p>
<ul class="org-ul">
<li>Outbound Network Traffic
</li>
<li>User Activities/Failed Logins
</li>
<li>User profile folders
</li>
<li>Administrative Access
</li>
<li>Access from unsual IP addresses
</li>
<li>Database IO: excessive READs
</li>
<li>Size of responses of web pages 
</li>
<li>Unusual access to particular files within Web Application (backdoor)
</li>
<li>Unusual port/protocol connections
</li>
<li>DNS and HTTP traffic requests
</li>
<li>Suspicious Scripts, Executables and Data Files
</li>
</ul>
</section>
</section>
<section>
<section id="sec-10" >

<h2>Challenges</h2>
<p>
Why we need IOCs? because it makes it easier to
systematically describe knowledge about breaches.
</p>

<ul class="org-ul">
<li>Identifying intrusions is hard
</li>
<li>Unfair game:
<ul class="org-ul">
<li>defender should protect all the assets
</li>
<li>attacker only needs to 'poop' one system.
</li>
</ul>
</li>
<li>Identifying targeted, organized intrusions is even harder
</li>
<li>Minor anomalous events are important when put together
</li>
<li>Seeing global picture is a mast
</li>
<li>Details matter
</li>
<li>Attribution is hard
</li>
</ul>
</section>
</section>
<section>
<section id="sec-11" >

<h2>Challenges</h2>
<p>
<b>All networks are compromised</b>
</p>


<p>
The difference between a good security team and a bad security team is
that with a bad security team you will never know that you've been
compromised.
</p>
</section>

</section>
<section>
<section id="sec-12" >

<h2>An Example</h2>
<p>
A Network compromise case study:
</p>
<ul class="org-ul">
<li>Attackers broke via a web vuln.
</li>
<li>Attackers gained local admin access
</li>
<li>Attackers created a local user
</li>
<li>Attackers started probing other machines for default user ids
</li>
<li>Attackers launched tunneling tools – connecting back to C2
</li>
<li>Attackers installed RATs to maintain access
</li>
</ul>
</section>
</section>
<section>
<section id="sec-13" >

<h2>Indicators</h2>
<p>
So what are the compromise indicators here?
</p>

<ul class="org-ul">
<li>Where did attackers come from? (IP)
</li>
<li>What vulnerability was exploited? (pattern)
</li>
<li>What web backdoor was used? (pattern, hash)
</li>
<li>What tools were uploaded? (hashes)
</li>
<li>What users were created locally? (username)
</li>
<li>What usernames were probed on other machines
</li>
</ul>
</section>

</section>
<section>
<section id="sec-14" >

<h2>Good or Bad?</h2>
<div class="org-src-container">

<pre class="src src-sh">File Name                       : RasTls.exe
File Size                       : 105 kB
File Modification Date/Time     : 2009:02:09 19:42:05+08:00
File Type                       : Win32 EXE
MIME Type                       : application/octet-stream
Machine Type                    : Intel 386 or later, and compatibles
Time Stamp                      : 2009:02:02 13:38:37+08:00
PE Type                         : PE32
Linker Version                  : 8.0
Code Size                       : 49152
Initialized Data Size           : 57344
Uninitialized Data Size         : 0
Entry Point                     : 0x3d76
OS Version                      : 4.0
Image Version                   : 0.0
Subsystem Version               : 4.0
Subsystem                       : Windows GUI
File Version Number             : 11.0.4010.7
Product Version Number          : 11.0.4010.7
File OS                         : Windows NT 32-bit
Object File Type                : Executable application
Language Code                   : English (U.S.)
Character Set                   : Windows, Latin1
Company Name                    : Symantec Corporation
File Description                : Symantec 802.1x Supplicant
File Version                    : 11.0.4010.7
Internal Name                   : dot1xtray
</pre>
</div>
</section>
</section>
<section>
<section id="sec-15" >

<h2>It really depends on context</h2>
<div class="org-src-container">

<pre class="src src-sh">RasTls.DLL 
RasTls.DLL.msc
RasTls.exe
</pre>
</div>

<p>
<a href="http://msdn.microsoft.com/en-us/library/ms682586(v=VS.85).aspx">http://msdn.microsoft.com/en-us/library/ms682586(v=VS.85).aspx</a>
</p>

<p>
<b>Dynamic-Link Library Search Order</b>
</p>

<img src="images/pantsdown.jpg" alt="pantsdown.jpg" />
</section>



</section>
<section>
<section id="sec-16" >

<h2>Tools for Dynamic Detection of IOC</h2>
<ul class="org-ul">
<li>Snort
</li>
<li>Yara + yara-enabled tools
</li>
<li>Moloch
</li>
</ul>
</section>

</section>
<section>
<section id="sec-17" >

<h2>Platforms useful for IOC</h2>
<ul class="org-ul">
<li>passive HTTP (keep your data recorded)
</li>
<li>passive DNS
</li>
</ul>

<p>
ability to mine traffic or patterns from the past
based on IOC similarity
</p>

<p>
<b>show me all the packets similar to this IOC</b>
</p>

<p>
We implemented a whois service for IOC look-ups
</p>
<div class="org-src-container">

<pre class="src src-sh">whois -h ioc.host.com   attribute:value+attribute:value
</pre>
</div>
</section>
</section>
</div>
</div>
<script src="./reveal.js/lib/js/head.min.js"></script>
<script src="./reveal.js/js/reveal.min.js"></script>
<script>

        		// Full list of configuration options available here:
        		// https://github.com/hakimel/reveal.js#configuration
        		Reveal.initialize({
        			controls: true,
        			progress: true,
        			history: false,
        			center: true,
        			rollingLinks: true,
        			keyboard: true,
        			overview: true,
        			width: 1200, // slide width
        			height: 800, // slide height
        			margin: 0.10, // slide margin
        			minScale: 0.50, // slide minimum scaling factor
        			maxScale: 2.50, // slide maximum scaling factor


        			theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        			transition: Reveal.getQueryHash().transition || 'cube', // default/cube/page/concave/zoom/linear/fade/none
        			transitionSpeed: 'default',

        			// Optional libraries used to extend on reveal.js
        			dependencies: [
        				{ src: './reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } }
        				,{ src: './reveal.js/plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } }
        				,{ src: './reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } }
        				,{ src: './reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
        				,{ src: './reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } }
        				,{ src: './reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        				// { src: './reveal.js/plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
        				// { src: './reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
         				
        			]
        		});
</script>
</body>
</html>
